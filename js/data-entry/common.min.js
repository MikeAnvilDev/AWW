function checkStatus(a) { if (a.hasOwnProperty("status")) { var b = a.status; return convertToBoolean(b) } return alert("an error has occurred"), !1 } function checkCookie(a) { if (cookie = document.cookie, cookieValue = null, null != cookie) for (var b = cookie.split(";"), c = 0; c < b.length; c++) { var d = b[c].split("="); d[0].replace(/^\s\s*/, "").replace(/\s\s*$/, "") == a && d[1].length > 0 && (cookieValue = d[1]) } return cookieValue } function setCookie(a, b) { var c = new Date; c.setDate(c.getDate() + 365), document.cookie = a + "=" + b + "; expires=" + c.toUTCString() + "; path=/" } function getToken() { console.log("common.js: getToken: retrieving token"); var a = null; return a = "undefined" != typeof Storage ? window.localStorage.getItem("token") : checkCookie("token"), console.log("common.js: getToken: token = " + a), a } function storeToken(a) { console.log("common.js: storeToken: storing token"), "undefined" != typeof Storage ? localStorage.setItem("token", a) : setCookie("token", a) } function clearToken() { console.log("common.js: clearToken: clearing token"), "undefined" != typeof Storage ? localStorage.removeItem("token") : setCookie("token", ""), location.href = "../login/index.html?error=" + encodeURIComponent("Your session has expired.") } function clearTokenWithError(a) { console.log("common.js: clearToken: clearing token"), "undefined" != typeof Storage ? localStorage.removeItem("token") : setCookie("token", ""), location.href = "../login/index.html?error=" + encodeURIComponent(a) } function checkForToken(a) { return console.log("common.js: checkForToken: check for token"), a.hasOwnProperty("token") ? (console.log("common.js: checkForToken: has token"), storeToken(a.token), !0) : (console.log("common.js: checkForToken: no token"), clearToken(), !1) } function validateToken(a) { console.log("common.js: validateToken: check token"), token = getToken(), null != token ? (console.log("common.js: validateToken: has token"), jQuery.support.cors = !0, $.ajax({ url: "https://msapps.acesag.auburn.edu/aww/api/home/ValidateToken", dataType: "json", type: "GET", contentType: "application/json", headers: { Authorization: "Bearer " + token }, cache: !1, success: function (b) { convertToBoolean(b.status) ? (console.log("common.js: validateToken: valid token"), storeToken(b.token), "function" == typeof a && a()) : clearToken() }, error: function (a, b, c) { clearToken() } })) : (console.log("common.js: validateToken: no token"), clearToken()) } function setUpAutoSave(a, b) { console.log("common.js: setUpAutoSave"), a.find("input").blur(function () { console.log("common.js: setUpAutoSave:input fired, " + b + ", " + a), storeFormLocally(a, b) }), a.find("textarea").blur(function () { console.log("common.js: setUpAutoSave: textarea fired, " + b + ", " + a), storeFormLocally(a, b) }), a.find("select").change(function () { console.log("common.js: setUpAutoSave: select fired, " + b + ", " + a), storeFormLocally(a, b) }) } function loadLocallyStored(a) { if (console.log("common.js: loadLocallyStored: loading locally stored information"), "undefined" != typeof Storage) { var b = localStorage.getItem(a); if (null === b) return console.log("common.js: loadLocallyStored: nothing locally stored"), !1; if (b.length > 0) { console.log("common.js: loadLocallyStored: something locally stored"); var c = new Object, d = b.split(","); $.each(d, function (a, b) { var d = b.split(":"); c[d[0]] = decodeString(d[1]) }); for (var e in c) c.hasOwnProperty(e) && (console.log("common.js: loadLocallyStored: input id = " + e), $("#" + e).is("[type=checkbox]") ? (console.log("common.js: loadLocallyStored: populating checkbox"), $("#" + e).prop("checked", "true" == c[e])) : $("#" + e).is("[type=radio]") ? (console.log("common.js: loadLocallyStored: populating radio"), $("#" + e).prop("checked", "true" == c[e])) : (console.log("common.js: loadLocallyStored: populating input"), $("#" + e).val(c[e]))); return !0 } return console.log("common.js: loadLocallyStored: nothing locally stored"), !1 } console.log("locally stored unavailable") } function clearLocallyStoredForm(a) { "undefined" != typeof Storage && localStorage.removeItem(a) } function storeFormLocally(a, b) { if (console.log("common.js: storeFormLocally: storing form"), "undefined" != typeof Storage) { var c = new Array, d = a.find("input, select, textarea"); d.each(function () { var a = $(this); console.log("common.js: storeFormLocally: input id =" + a.attr("id")), a.is("[type=checkbox]") ? c.push(a.attr("id") + ":" + a.prop("checked")) : a.is("[type=radio]") ? c.push(a.attr("id") + ":" + a.prop("checked")) : c.push(a.attr("id") + ":" + encodeString(a.val())) }), localStorage.setItem(b, c.join(",")), console.log("common.js: storeFormLocally: form stored"), console.log(b + ": " + localStorage.getItem(b)) } else console.log("common.js: storeFormLocally: storage unavailable") } function convertToBoolean(a) { var a = a.toLowerCase(); return "ok" == a || "true" == a || "1" == a || "200" == a } function getQueryVariable(a) { for (var b = window.location.search.substring(1), c = b.split("&"), d = 0; d < c.length; d++) { var e = c[d].split("="); if (e[0] == a) return e[1] } return "" } function encodeString(a) { return a.replace(":", "%3A").replace(",", "%2C") } function decodeString(a) { return a.replace("%3A", ":").replace("%2C", ",") }