function loadData() { $("#Groupid").val(decodeURIComponent(getQueryVariable("Groupid"))), $("#Group_Name").val(decodeURIComponent(getQueryVariable("Group_Name"))), $("#Group_Abbreviation").val(decodeURIComponent(getQueryVariable("Group_Abbreviation"))), $("#AwwSiteCode").val(decodeURIComponent(getQueryVariable("AwwSiteCode"))), $("#WebMasterSiteId").val(decodeURIComponent(getQueryVariable("WebMasterSiteId"))), $("#Watershed").val(decodeURIComponent(getQueryVariable("Watershed"))), $("#Waterbody_Name").val(decodeURIComponent(getQueryVariable("Waterbody_Name"))), $("#HUC11").val(decodeURIComponent(getQueryVariable("HUC11"))), $("#HUC8").val(decodeURIComponent(getQueryVariable("HUC8"))), $("#HUC6").val(decodeURIComponent(getQueryVariable("HUC6"))), $("#HUC4").val(decodeURIComponent(getQueryVariable("HUC4"))), $("#county").val(decodeURIComponent(getQueryVariable("county"))), $("#state").val(decodeURIComponent(getQueryVariable("state"))), $("#SamplingSiteLocation").val(decodeURIComponent(getQueryVariable("SamplingSiteLocation"))) } function setUpCalculations() { $("#DO1, #DO2").keyup(calculateAverageDO), $("#DO1, #DO2").blur(calculateAverageDO), $("#SampleDate, #SampleTime").keyup(combineDateTime), $("#SampleDate, #SampleTime").blur(combineDateTime), $("#Alkalinity").keyup(calculateAlkalinity), $("#Alkalinity").blur(calculateAlkalinity), $("#Hardness").keyup(calculateHardness), $("#Hardness").blur(calculateHardness), $("#Turb1, #Turb2").keyup(calculateTurbity), $("#Turb1, #Turb2").blur(calculateTurbity), $("#CertificationConfirmation").click(updateAuthorization) } function calculateAverageDO() { var a = $("#DO1").val(); a.length > 0 ? validateDecimal(a) && (a = 0) : a = 0, a = parseFloat(a); var b = $("#DO2").val(); b.length > 0 ? validateDecimal(b) && (b = 0) : b = 0, b = parseFloat(b); var c = 0; c = Math.abs(b - a) > 6 ? "" : (a + b) / 2, $("#AvgDo").val(c) } function calculateAlkalinity() { var a = $("#Alkalinity").val(); a.length > 0 ? validateDecimal(a) && (a = 0) : a = 0; var b = 5 * a; $("#Alkalinity-calculated").val(b) } function calculateHardness() { var a = $("#Hardness").val(); a.length > 0 ? validateDecimal(a) && (a = 0) : a = 0; var b = 10 * a; $("#Hardness-calculated").val(b) } function calculateTurbity() { var a = $("#Turb1").val(); a.length > 0 ? validateDecimal(a) && (drops1 = 0) : a = 0; var b = 50, c = 50 / b * 5 * a; $("#Turb1-calculated").val(c); var d = $("#Turb2").val(); d.length > 0 ? validateDecimal(d) && (d = 0) : d = 0, b = 25, c = 50 / b * 5 * d, $("#Turb2-calculated").val(c) } function validateDecimal(a) { return a.search(/^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/) == -1 } function combineDateTime() { var a = $("#SampleDate").val(), b = $("#SampleTime").val(); a.length > 0 && b.length > 0 ? $("#SampleDateTime").val(a + " " + b) : $("#SampleDateTime").val("") } function updateMonitors() { var a = $("#Monitors ul li input"); $.each(a, function () { var a = $(this); a.prop("checked") ? a.closest("label").addClass("highlite") : a.closest("label").removeClass("highlite") }) } function updateAuthorization() { var a = $("#CertificationConfirmation"); a.prop("checked") ? a.closest("div.authorization").addClass("highlite") : a.closest("div.authorization").removeClass("highlite") } function loadMonitors() { $.support.cors = !0; var a = getToken(); $.ajax({ url: "https://msapps.acesag.auburn.edu/aww/api/home/GetSiteMonitors", dataType: "json", type: "GET", data: { id: $("#WebMasterSiteId").val() }, contentType: "application/json", headers: { Authorization: "Bearer " + a }, cache: !1, success: function (a) { var b = $("#Monitors ul"); $.each(a.monitors, function (a, c) { var d = $("<li></li>"), e = $("<label>" + c.firstName + " " + c.lastName + "</label>"), f = $('<input type="checkbox" value="' + c.contactID + '" name="MonitorIDs" ml-val ml-val-required="true" ml-val-label="A monitor is required."/>'); f.click(updateMonitors), b.append(d), d.append(e), e.append(f), b.find() }) }, error: function (a, b, c) { console.log(a) } }) } function loadChemistry() { loadData(), setUpCalculations(), loadMonitors(), storedKeyName = $("#AwwSiteCode").val() + "-chemistry", loadLocallyStored(storedKeyName), setUpAutoSave($("form.ml-validation"), storedKeyName) } function submitChemForm(a, b) { if (displayContentOverlay(!0), b) { var c = $(a), d = c.closest("form.ml-validation"); $.support.cors; var e = getToken(), f = d.serialize(), g = d.attr("ml-post-to"); $.ajax({ url: g, type: "POST", headers: { Authorization: "Bearer " + e }, data: f, dataType: "json", cache: !1, success: function (a) { var b = $("#AwwSiteCode").val(); d.empty(), clearLocallyStoredForm(b + "-chemistry"), displayContentOverlay(!1), $("#Success-Section").show() }, error: function (a, b, c) { console.log(a) } }) } else displayContentOverlay(!1) } var storedKeyName = null; $(window).on("load", function () { validateToken(loadChemistry) });