function loadData() { $("#Groupid").val(decodeURIComponent(getQueryVariable("Groupid"))), $("#Group_Name").val(decodeURIComponent(getQueryVariable("Group_Name"))), $("#Group_Abbreviation").val(decodeURIComponent(getQueryVariable("Group_Abbreviation"))), $("#AwwSiteCode").val(decodeURIComponent(getQueryVariable("AwwSiteCode"))), $("#WebMasterSiteId").val(decodeURIComponent(getQueryVariable("WebMasterSiteId"))), $("#Watershed").val(decodeURIComponent(getQueryVariable("Watershed"))), $("#Waterbody_Name").val(decodeURIComponent(getQueryVariable("Waterbody_Name"))), $("#HUC11").val(decodeURIComponent(getQueryVariable("HUC11"))), $("#HUC8").val(decodeURIComponent(getQueryVariable("HUC8"))), $("#HUC6").val(decodeURIComponent(getQueryVariable("HUC6"))), $("#HUC4").val(decodeURIComponent(getQueryVariable("HUC4"))), $("#county").val(decodeURIComponent(getQueryVariable("county"))), $("#state").val(decodeURIComponent(getQueryVariable("state"))), $("#SamplingSiteLocation").val(decodeURIComponent(getQueryVariable("SamplingSiteLocation"))), $("#SubmitterContactId").val(decodeURIComponent(getQueryVariable("SubmitterContactId"))) } function setUpCalculations() { $("#EColi1, #EColi2, #EColi3, #ColonyCount1, #ColonyCount2, #ColonyCount3").keyup(calculateColiformAverage), $("#EColi1, #EColi2, #EColi3, #ColonyCount1, #ColonyCount2, #ColonyCount3").blur(calculateColiformAverage), $("#SampleDate, #SampleTime").keyup(combineDateTime), $("#SampleDate, #SampleTime").blur(combineDateTime), $("#CertificationConfirmation").click(updateAuthorization) } function calculateColiformAverage() { var a = 0, b = 0, c = $("#EColi1"), d = $("#EColi2"), e = $("#EColi3"); c.val().length > 0 && (ecoli1 = parseInt(c.val()), a += ecoli1, b++), d.val().length > 0 && (ecoli2 = parseInt(d.val()), a += ecoli2, b++), e.val().length > 0 && (ecoli3 = parseInt(e.val()), a += ecoli3, b++); var f = ""; b > 0 && (f = Math.ceil(a / b)), $("#ttlecoli").val(f); var g = 0, h = 0, i = $("#ColonyCount1"), j = $("#ColonyCount2"), k = $("#ColonyCount3"); i.val().length > 0 && (ocoli1 = parseInt(i.val()), g += ocoli1, h++), j.val().length > 0 && (ocoli2 = parseInt(j.val()), g += ocoli2, h++), k.val().length > 0 && (ocoli3 = parseInt(k.val()), g += ocoli3, h++); var l = ""; h > 0 && (l = Math.ceil(g / h)), $("#ttlocoli").val(l) } function combineDateTime() { var a = $("#SampleDate").val(), b = $("#SampleTime").val(); a.length > 0 && b.length > 0 ? $("#SampleDateTime").val(a + " " + b) : $("#SampleDateTime").val("") } function updateMonitors() { var a = $("#Monitors ul li input"); $.each(a, function () { var a = $(this); a.prop("checked") ? a.closest("label").addClass("highlite") : a.closest("label").removeClass("highlite") }) } function updateAuthorization() { var a = $("#CertificationConfirmation"); a.prop("checked") ? a.closest("div.authorization").addClass("highlite") : a.closest("div.authorization").removeClass("highlite") } function loadMonitors() { $.support.cors = !0; var a = getToken(); $.ajax({ url: "https://msapps.acesag.auburn.edu/aww/api/home/GetSiteMonitors", dataType: "json", type: "GET", data: { id: $("#WebMasterSiteId").val() }, contentType: "application/json", headers: { Authorization: "Bearer " + a }, cache: !1, success: function (a) { var b = $("#Monitors ul"); $.each(a.monitors, function (a, c) { var d = $("<li></li>"), e = $("<label>" + c.firstName + " " + c.lastName + "</label>"), f = $('<input type="checkbox" value="' + c.contactID + '" name="MonitorIDs" ml-val ml-val-required="true" ml-val-label="A monitor is required."/>'); f.click(updateMonitors), b.append(d), d.append(e), e.append(f), b.find() }) }, error: function (a, b, c) { console.log(a) } }) } function loadBacteria() { loadData(), setUpCalculations(), loadMonitors(), storedKeyName = $("#AwwSiteCode").val() + "-bacteria", loadLocallyStored(storedKeyName), setUpAutoSave($("form.ml-validation"), storedKeyName) } function submitBactForm(a, b) { if (displayContentOverlay(!0), b) { var c = $(a), d = c.closest("form.ml-validation"); $.support.cors; var e = getToken(), f = d.serialize(), g = d.attr("ml-post-to"); $.ajax({ url: g, type: "POST", headers: { Authorization: "Bearer " + e }, data: f, dataType: "json", cache: !1, success: function (a) { var b = $("#AwwSiteCode").val(); d.empty(), clearLocallyStoredForm(b + "-bacteria"), displayContentOverlay(!1), $("#Success-Section").show() }, error: function (a, b, c) { console.log(a) } }) } else displayContentOverlay(!1) } var storedKeyName = null; $(window).on("load", function () { validateToken(loadBacteria) });